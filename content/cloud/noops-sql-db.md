title = "NoOps SQL Database"
template = "cloud_main"
date = "2023-07-26T16:00:00Z"
enable_shortcodes = true
[extra]
url = "https://github.com/fermyon/developer/blob/main/content/cloud/noops-sql-db.md"

---
- [Accessing Private Beta](#accessing-private-beta)
- [Quotas And Service Limitations For the Database in Fermyon Cloud](#quotas-and-service-limitations-for-the-database-in-fermyon-cloud)
- [Creating a New Spin Application](#creating-a-new-spin-application)
- [Grant SQLite Permission](#grant-sqlite-permission)
- [Managing Your Local Spin Database Schema](#managing-your-local-spin-database-schema)
- [Tables and Data in Fermyon Cloud](#tables-and-data-in-fermyon-cloud)
  - [Implicitly Create A Database Via `spin cloud deploy`](#implicitly-create-a-database-via-spin-cloud-deploy)
  - [Explicitly Create A Database Via `spin cloud sqlite create`](#explicitly-create-a-database-via-spin-cloud-sqlite-create)
- [Deleting the Cloud Database](#deleting-the-cloud-database)
- [FAQ](#faq)
- [Next Steps](#next-steps)

With NoOps SQL Database using SQLite support in Fermyon Cloud, you can persist relational data generated by your [Spin](../spin/install.md) application in between application invocations without worrying about database management. Fermyon Cloud will provision and manage the database on your behalf:, no operations (NoOps) are required. Fermyon Cloud will do the heavy lifting for you. To learn more about the Spin SQLite SDK, please visit the [API guide](../spin/sqlite-api-guide.md).

<iframe width="854" height="480" src="https://www.youtube.com/embed/buwr66oRPbU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Accessing Private Beta

The database in Fermyon Cloud is currently in private beta. To request access to the private beta, please fill out this short [sign-up form](https://fibsu0jcu2g.typeform.com/to/Brv12FI0#hubspot_utk=xxxxx&hubspot_page_name=xxxxx&hubspot_page_url=xxxxx).
 
> Please note that the private beta is limited in space, and all requests cannot be guaranteed. 

Once you have access to the private beta, please ensure you have [Spin CLI](./cli-reference.md) v1.4 or greater, and [`cloud` plugin](https://github.com/fermyon/cloud-plugin) v0.3.1 or greater installed. 

## Quotas And Service Limitations For the Database in Fermyon Cloud

*Quotas* 
* You can have a maximum of 1 NoOps SQL Database in your Cloud account
* Your NoOps SQL Database can hold up 1 GB of data

*Service Limitations*
* To run a SQL statement (for migration and schema creation), use the `spin cloud sqlite list` and `spin cloud sqlite execute` commands. The equivalent of `spin up --sqlite` for `spin deploy` does currently not exist in Cloud. [See this section for more info](#tables-and-data-in-fermyon-cloud).

## Creating a New Spin Application

If you already have a Spin application, you can skip this step. If you do not have a Spin application locally you will need to [create one](/spin/quickstart#create-your-first-application).

## Grant SQLite Permission

To tell Spin that we want to use SQLite storage, we only need to [grant SQLite permission to a component in the applicationâ€™s manifest](/spin/sqlite-api-guide#granting-sqlite-database-permissions-to-components) (the `spin.toml` file) by supplying a [label](linking-applications-to-resources-using-labels.md). For example:

```
[component]
sqlite_databases = ["default"]
```

The new database file (`sqlite_db.db`) is created in your application's `.spin` folder when you run this Spin application. The database persists across Spin application invocations and updates. The database is empty and can optionally have tables and data added using the following step.

## Managing Your Local Spin Database Schema

See [preparing an SQLite database](https://developer.fermyon.com/spin/sqlite-api-guide#preparing-an-sqlite-database) for more information on using the `spin up` subcommand's `--sqlite` option to create and populate tables locally. No **Cloud** database is created or changed as a result of using this this optional `spin up --sqlite` example. Populating this local database can be useful for testing (the relationship between your application's logic and your schema) before deploying your application to Fermyon Cloud.

## Tables and Data in Fermyon Cloud

You have two options to create your database (both are equally valid):
* Option A: Implicitly create a database (with an automatically assigned arbitrary database name) via `spin cloud deploy`. For example `inspirational-pig` or similarly named database will be created.
* Option B : Explicitly provide the name of the database to create via the `spin cloud sqlite create` command. For example, `spin cloud sqlite create finance-database` creates a database called `finance-database` inside your Fermyon Cloud account.

Please run whatever step is relevant to your needs.

### Implicitly Create A Database Via `spin cloud deploy`

When you first `spin cloud deploy` your application (with the `sqlite_databases` configuration, as shown above), Fermyon Cloud will create a new database for your Cloud application.

The new database is initially empty, so you will need to create tables (and potentially initial data) before it is useful.  To do this:

1. Find the name of your Cloud database. To do this, run the following command:

<!-- @selectiveCpy -->

```bash
$ spin cloud sqlite list
Databases (1)
inspirational-pig (default)
```

2. Run `spin cloud sqlite execute`, passing the name of the database and the SQL statement(s) needed to create your Cloud database's tables and initial data.

> See the [SQLite documentation](https://www.sqlite.org/lang.html) for information about the SQLite dialect of SQL.

<!-- @selectiveCpy -->

```bash
$ spin cloud sqlite execute inspirational-pig "CREATE TABLE IF NOT EXISTS todos (id INTEGER PRIMARY KEY AUTOINCREMENT,description TEXT NOT NULL,due_date DATE,starred BOOLEAN DEFAULT 0,is_completed BOOLEAN DEFAULT 0)"
```

> Note: The Cloud database is completely unrelated to the local database, and must be prepared separately.

### Explicitly Create A Database Via `spin cloud sqlite create`

1. You can create your NoOps SQL DB using the following command:

``<!-- @selectiveCpy -->

```bash
$ spin cloud sqlite create mydb
```

2. Run `spin cloud sqlite execute`, passing the name of the database and the SQL statement(s) needed to create your Cloud database's tables and initial data.

> See the [SQLite documentation](https://www.sqlite.org/lang.html) for information about the SQLite dialect of SQL.

<!-- @selectiveCpy -->

```bash
$ spin cloud sqlite execute mydb "CREATE TABLE IF NOT EXISTS todos (id INTEGER PRIMARY KEY AUTOINCREMENT,description TEXT NOT NULL,due_date DATE,starred BOOLEAN DEFAULT 0,is_completed BOOLEAN DEFAULT 0)"
```

> Note: The Cloud database is completely unrelated to the local database, and must be prepared separately.

Now you can deploy your application and select `mydb` as the resource you would like to link your application to: 

```bash
```bash
spin deploy
Uploading todo-app version 0.1.0-r234fe5a4 to Fermyon Cloud...
Deploying...
App "todo-app" accesses a database labeled "default"
Would you like to link an existing database or create a new database?:
> Use an existing database and link app to it
  Create a new database and link the app to it
```

Since we chose to link to an existing database, `spin deploy` asks us which database we would like to link this app's "data" label to:

```bash
Which database would you like to link to todo-app using the label "data":
> mydb
  finance
  projects
  inspirational-pig
```

## Deleting the Cloud Database

Warning: using the `delete` subcommand is **permanent**. 

You can delete your default database with the following command:

<!-- @selectiveCpy -->

```bash
$ spin cloud sqlite delete inspirational-pig
The action is irreversible.
Please type "inspirational-pig" for confirmation: inspirational-pig
Deleting database ...
Database "inspirational-pig" deleted
```

> In the Private Beta, we do not have support for sharing database between apps. However, we still separate out the database deletion from app deletion because we anticipate the ability to use databases from multiple apps in the future.

## FAQ

- **Can I export data from my database?**
At this time, Fermyon Cloud does not have a data export feature. We'd love to hear your thoughts on what an ideal experience would look like at [github.com/fermyon/feedback](https://github.com/fermyon/feedback)

- **If I upgrade my Spin application, can I still access the same instance of my database?**
Yes, as long as you haven't deleted your database, the instance will be running and stateful. 

- **If I delete and redeploy my Spin application, can I still access the same instance of my database?**
No, at this time you cannot access the database. You will need to delete the instance and provision a new one. 

## Next Steps

* For support or feature feedback, please join our [Discord channel #no-ops-db-beta](https://discord.gg/XxkZvsya). This is where you can provide feedback and ask for assistance from the Fermyon Cloud team on all things NoOps SQL Database. 
